<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work Hours & Bills Calculator</title>
<style>
  body { font-family: Arial, sans-serif; margin: 10px; background: #f9f9f9; }
  h2 { color: #4CAF50; text-align: center; }
  label { font-weight: bold; margin-top: 10px; display: block; }
  input { margin: 5px 0 15px; padding: 8px; width: 100%; max-width: 250px; box-sizing: border-box; }
  button { padding: 10px 15px; margin: 5px 2px; cursor: pointer; border: none; background: #4CAF50; color: white; font-weight: bold; border-radius: 5px; }
  button:hover { background: #45a049; }
  .table-container { overflow-x:auto; margin-top:20px; }
  table { border-collapse: collapse; width: 100%; min-width: 900px; background: white; }
  th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
  th { background: #4CAF50; color: white; }
  tfoot { font-weight: bold; background: #eee; }
  ul#billList, ul#incomeList { padding-left: 15px; }
  .section { margin-top:20px; }
</style>
</head>
<body>

<h2>Work Hours & Bills Calculator</h2>

<p><b>Instructions:</b></p>
<ol>
  <li>Enter your <b>hourly wage</b> and optional <b>tax rate</b> (default 22%).</li>
  <li>Add <b>Bills</b> or <b>Other Income</b> separately.</li>
  <li>Other income includes Tips, Bonuses, and Commissions (optional).</li>
  <li>Click <b>Calculate</b> to see hours needed, taxes, and savings.</li>
  <li>Click <b>Reset</b> to start over.</li>
  <li>You can download the results as <b>CSV</b> or <b>PDF</b>.</li>
</ol>

<div class="section">
  <label>Hourly Wage ($):</label>
  <input type="number" id="wage" placeholder="e.g. 21">

  <label>Tax Rate (%):</label>
  <input type="number" id="taxRate" placeholder="Default 22" value="22">
</div>

<div class="section">
  <h3>Add Bill</h3>
  <label>Bill Nickname:</label>
  <input type="text" id="billName" placeholder="e.g. Rent">

  <label>Bill Amount ($):</label>
  <input type="number" id="bill" placeholder="e.g. 140">

  <button onclick="addBill()">Add Bill</button>

  <h4>Added Bills:</h4>
  <ul id="billList"></ul>
</div>

<div class="section">
  <h3>Add Other Income</h3>

  <label>Tips ($):</label>
  <input type="number" id="tips" placeholder="Optional">

  <label>Bonuses ($):</label>
  <input type="number" id="bonuses" placeholder="Optional">

  <label>Commissions ($):</label>
  <input type="number" id="commissions" placeholder="Optional">

  <button onclick="addIncome()">Add Other Income</button>

  <h4>Added Other Income:</h4>
  <ul id="incomeList"></ul>
</div>

<div class="section">
  <button onclick="calculate()">Calculate</button>
  <button onclick="resetCalculator()">Reset</button>
</div>

<div id="result" class="table-container"></div>

<div id="downloadButtons" style="display:none;">
  <button onclick="downloadCSV()">Download CSV</button>
  <button onclick="downloadPDF()">Download PDF</button>
</div>

<details>
  <summary style="cursor:pointer; font-weight:bold; color:#4CAF50; font-size:1.1rem;">
    ðŸ“Š How Calculations Work
  </summary>
  <ul style="margin-top:10px;">
    <li>Wages Earned = Rounded Hours Ã— Wage</li>
    <li>Hours Needed = ceil(Bill Ã· Net Hourly Wage)</li>
    <li>Earnings Before Tax = Wages + Tips + Bonuses + Commissions</li>
    <li>Taxes = Earnings Before Tax Ã— TaxRate</li>
    <li>Savings = Earnings After Tax - Bill Amount</li>
  </ul>
</details>

<script>
let bills = [];
let otherIncome = [];

function addBill() {
  const name = document.getElementById('billName').value.trim();
  const amount = parseFloat(document.getElementById('bill').value);

  if (!name || isNaN(amount) || amount <= 0) {
    alert("Please enter a valid nickname and bill amount.");
    return;
  }

  bills.push({ name, amount });

  document.getElementById('billList').innerHTML = bills.map(b => 
    `<li>${b.name}: $${b.amount.toFixed(2)}</li>`
  ).join("");

  document.getElementById('billName').value = '';
  document.getElementById('bill').value = '';
}

function addIncome() {
  const tips = parseFloat(document.getElementById('tips').value) || 0;
  const bonuses = parseFloat(document.getElementById('bonuses').value) || 0;
  const commissions = parseFloat(document.getElementById('commissions').value) || 0;

  if(tips === 0 && bonuses === 0 && commissions === 0) {
    alert("Please enter at least one value for Tips, Bonuses, or Commissions.");
    return;
  }

  otherIncome.push({ tips, bonuses, commissions });

  document.getElementById('incomeList').innerHTML = otherIncome.map((i,index) => 
    `<li>Other Income #${index+1}: Tips $${i.tips.toFixed(2)}, Bonuses $${i.bonuses.toFixed(2)}, Commissions $${i.commissions.toFixed(2)}</li>`
  ).join("");

  document.getElementById('tips').value = '';
  document.getElementById('bonuses').value = '';
  document.getElementById('commissions').value = '';
}

function calculate() {
  const wage = parseFloat(document.getElementById('wage').value);
  const taxRate = parseFloat(document.getElementById('taxRate').value)/100 || 0.22;

  if (isNaN(wage) || wage <= 0) {
    alert("Please enter a valid wage.");
    return;
  }

  if (bills.length === 0 && otherIncome.length === 0) {
    alert("Please add at least one bill or other income.");
    return;
  }

  let table = `
    <table>
      <tr>
        <th>Item</th>
        <th>Bill Amount ($)</th>
        <th>Hours Needed</th>
        <th>Wages Earned ($)</th>
        <th>Tips ($)</th>
        <th>Bonuses ($)</th>
        <th>Commissions ($)</th>
        <th>Earnings Before Tax ($)</th>
        <th>Taxes ($)</th>
        <th>Amount Paid ($)</th>
        <th>Savings ($)</th>
      </tr>
  `;

  let totals = { bill:0, hours:0, wages:0, tips:0, bonuses:0, commissions:0, earnings:0, taxes:0, paid:0, savings:0 };

  bills.forEach(bill => {
    const netHourly = wage * (1 - taxRate);
    const exactHours = bill.amount / netHourly;
    const roundedHours = Math.ceil(exactHours);

    const wagesEarned = roundedHours * wage;
    const earningsBeforeTax = wagesEarned;
    const taxes = earningsBeforeTax * taxRate;
    const amountPaid = bill.amount;
    const savings = earningsBeforeTax - taxes - amountPaid;

    table += `
      <tr>
        <td>${bill.name}</td>
        <td>$${bill.amount.toFixed(2)}</td>
        <td>${roundedHours}</td>
        <td>$${wagesEarned.toFixed(2)}</td>
        <td>$0.00</td>
        <td>$0.00</td>
        <td>$0.00</td>
        <td>$${earningsBeforeTax.toFixed(2)}</td>
        <td>$${taxes.toFixed(2)}</td>
        <td>$${amountPaid.toFixed(2)}</td>
        <td>$${savings.toFixed(2)}</td>
      </tr>
    `;

    totals.bill += bill.amount;
    totals.hours += roundedHours;
    totals.wages += wagesEarned;
    totals.earnings += earningsBeforeTax;
    totals.taxes += taxes;
    totals.paid += amountPaid;
    totals.savings += savings;
  });

  otherIncome.forEach(income => {
    const wagesEarned = 0;
    const earningsBeforeTax = income.tips + income.bonuses + income.commissions;
    const taxes = earningsBeforeTax * taxRate;
    const amountPaid = 0;
    const savings = earningsBeforeTax - taxes;

    table += `
      <tr>
        <td>Other Income</td>
        <td>$0.00</td>
        <td>0</td>
        <td>$0.00</td>
        <td>$${income.tips.toFixed(2)}</td>
        <td>$${income.bonuses.toFixed(2)}</td>
        <td>$${income.commissions.toFixed(2)}</td>
        <td>$${earningsBeforeTax.toFixed(2)}</td>
        <td>$${taxes.toFixed(2)}</td>
        <td>$0.00</td>
        <td>$${savings.toFixed(2)}</td>
      </tr>
    `;

    totals.tips += income.tips;
    totals.bonuses += income.bonuses;
    totals.commissions += income.commissions;
    totals.earnings += earningsBeforeTax;
    totals.taxes += taxes;
    totals.savings += savings;
  });

  table += `
    <tfoot>
      <tr>
        <td><b>Totals</b></td>
        <td>$${totals.bill.toFixed(2)}</td>
        <td>${totals.hours}</td>
        <td>$${totals.wages.toFixed(2)}</td>
        <td>$${totals.tips.toFixed(2)}</td>
        <td>$${totals.bonuses.toFixed(2)}</td>
        <td>$${totals.commissions.toFixed(2)}</td>
        <td>$${totals.earnings.toFixed(2)}</td>
        <td>$${totals.taxes.toFixed(2)}</td>
        <td>$${totals.paid.toFixed(2)}</td>
        <td>$${totals.savings.toFixed(2)}</td>
      </tr>
    </tfoot>
  </table>`;

  document.getElementById('result').innerHTML = table;
  document.getElementById('downloadButtons').style.display = "block";
}

function resetCalculator() {
  bills = [];
  otherIncome = [];
  document.getElementById('billList').innerHTML = '';
  document.getElementById('incomeList').innerHTML = '';
  document.getElementById('result').innerHTML = '';
  document.getElementById('downloadButtons').style.display = "none";
  document.getElementById('wage').value = '';
  document.getElementById('taxRate').value = 22;
  document.getElementById('billName').value = '';
  document.getElementById('bill').value = '';
  document.getElementById('tips').value = '';
  document.getElementById('bonuses').value = '';
  document.getElementById('commissions').value = '';
}

function downloadCSV() {
  const table = document.querySelector("table");
  if (!table) return alert("No table to download.");
  let csv = [];
  table.querySelectorAll("tr").forEach(row => {
    csv.push(Array.from(row.querySelectorAll("td, th")).map(c => c.innerText.replace(/,/g,"")).join(","));
  });
  const csvFile = new Blob([csv.join("\n")], { type: "text/csv" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(csvFile);
  link.download = `work_hours_report_${new Date().toISOString().slice(0,10)}.csv`;
  link.click();
}

function downloadPDF() {
  const table = document.querySelector("table");
  if (!table) return alert("No table to download.");
  const printWindow = window.open('', '', 'height=600,width=1000');
  printWindow.document.write('<html><head><title>Work Hours Report</title>');
  printWindow.document.write('<style>body{font-family:Arial,sans-serif;} table { border-collapse: collapse; width: 100%; } th, td { border: 1px solid #ccc; padding: 10px; text-align: center; } th { background: #4CAF50; color: white; } tfoot { font-weight: bold; background: #eee; }</style>');
  printWindow.document.write('</head><body>');
  printWindow.document.write(`<h2>Work Hours & Bills Report (${new Date().toLocaleDateString()})</h2>`);
  printWindow.document.write(table.outerHTML);
  printWindow.document.write('</body></html>');
  printWindow.document.close();
  printWindow.print();
}
</script>

<footer style="text-align:center; margin-top:20px; font-size:0.9rem; color:#555;">
  Code by <b>Davi Nevae LLC</b> | <a href="https://www.davinevae.com" target="_blank">www.davinevae.com</a>
</footer

</body>
</html>
