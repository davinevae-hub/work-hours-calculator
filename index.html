<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Work Hours & Bills Calculator</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; background: #f9f9f9; }
    h2 { color: #4CAF50; text-align: center; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input { margin: 5px 0 15px; padding: 8px; width: 100%; max-width: 250px; box-sizing: border-box; }
    button { padding: 10px 15px; margin: 5px 2px; cursor: pointer; border: none; background: #4CAF50; color: white; font-weight: bold; border-radius: 5px; }
    button:hover { background: #45a049; }
    #downloadButtons { margin-top: 15px; display: none; }
    ul#billList { padding-left: 15px; }
    details { margin-top: 20px; }

    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: white; overflow-x: auto; display: block; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; min-width: 100px; }
    th { background: #4CAF50; color: white; }
    tfoot { font-weight: bold; background: #eee; }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      table, thead, tbody, th, td, tr { display: block; }
      tr { margin-bottom: 15px; border-bottom: 2px solid #ddd; }
      th { text-align: left; background: #4CAF50; color: white; padding-left: 10px; }
      td { text-align: left; padding-left: 10px; border: none; border-bottom: 1px solid #ccc; }
      td::before { content: attr(data-label); font-weight: bold; display: inline-block; width: 120px; }
    }
  </style>
</head>
<body>

  <h2>Work Hours & Bills Calculator</h2>

  <p><b>Instructions:</b></p>
  <ol>
    <li>Enter your <b>hourly wage</b> and <b>tax rate</b> (default is 22%).</li>
    <li>Add optional income fields: Tips, Bonuses, Commissions (leave blank if none).</li>
    <li>Add each bill with a nickname and amount.</li>
    <li>Click <b>Add Bill</b> to save each one. Optional income fields will reset for the next bill.</li>
    <li>Click <b>Calculate</b> to see hours needed, taxes, take-home pay, and savings, including optional income.</li>
    <li>Click <b>Reset</b> to start over.</li>
  </ol>

  <label>Hourly Wage ($):</label>
  <input type="number" id="wage" placeholder="e.g. 21">

  <label>Tax Rate (%):</label>
  <input type="number" id="taxRate" placeholder="Default 22" value="22">

  <label>Tips ($) - Optional:</label>
  <input type="number" id="tips" placeholder="Optional">

  <label>Bonuses ($) - Optional:</label>
  <input type="number" id="bonuses" placeholder="Optional">

  <label>Commissions ($) - Optional:</label>
  <input type="number" id="commissions" placeholder="Optional">

  <label>Bill Nickname:</label>
  <input type="text" id="billName" placeholder="e.g. Rent">

  <label>Bill Amount ($):</label>
  <input type="number" id="bill" placeholder="e.g. 140">

  <button onclick="addBill()">Add Bill</button>
  <button onclick="calculate()">Calculate</button>
  <button onclick="resetCalculator()">Reset</button>

  <h3>Added Bills:</h3>
  <ul id="billList"></ul>

  <div id="result"></div>

  <div id="downloadButtons">
    <button onclick="downloadCSV()">Download as CSV</button>
    <button onclick="downloadPDF()">Download as PDF</button>
  </div>

  <details>
    <summary style="cursor:pointer; font-weight:bold; color:#4CAF50; font-size:1.1rem;">
      ðŸ“Š How Calculations Work (click to expand)
    </summary>
    <ul style="margin-top:10px;">
      <li><b>Exact Hours:</b> Bill Ã· (Hourly Wage Ã— (1 - Tax Rate)) â†’ fractional hours needed.</li>
      <li><b>Rounded Hours:</b> Rounded up to nearest hour.</li>
      <li><b>Earnings Before Tax:</b> Rounded Hours Ã— Hourly Wage.</li>
      <li><b>Optional Income:</b> Tips + Bonuses + Commissions are added before tax calculation.</li>
      <li><b>Taxes:</b> (Earnings Before Tax + Optional Income) Ã— Tax Rate.</li>
      <li><b>Amount Earned:</b> Earnings + Optional Income - Taxes.</li>
      <li><b>Amount Paid:</b> Bill amount.</li>
      <li><b>Savings:</b> Amount Earned - Bill.</li>
    </ul>
  </details>

  <script>
    let bills = [];

    function addBill() {
      const name = document.getElementById('billName').value;
      const amount = parseFloat(document.getElementById('bill').value);

      if (!name || isNaN(amount) || amount <= 0) {
        alert("Please enter a valid nickname and bill amount.");
        return;
      }

      bills.push({ name, amount });
      document.getElementById('billList').innerHTML = bills.map(b => `<li>${b.name}: $${b.amount.toFixed(2)}</li>`).join("");

      // Reset bill input fields
      document.getElementById('billName').value = '';
      document.getElementById('bill').value = '';

      // Reset optional income fields for next bill
      document.getElementById('tips').value = '';
      document.getElementById('bonuses').value = '';
      document.getElementById('commissions').value = '';
    }

    function calculate() {
      const wage = parseFloat(document.getElementById('wage').value);
      const taxRate = parseFloat(document.getElementById('taxRate').value) / 100 || 0.22;
      const tips = parseFloat(document.getElementById('tips').value) || 0;
      const bonuses = parseFloat(document.getElementById('bonuses').value) || 0;
      const commissions = parseFloat(document.getElementById('commissions').value) || 0;

      if (isNaN(wage) || wage <= 0 || bills.length === 0) {
        alert("Please enter your wage and add at least one bill.");
        return;
      }

      let table = `
        <table>
          <tr>
            <th>Bill</th>
            <th>Bill Amount ($)</th>
            <th>Hours Needed</th>
            <th>Earnings Before Tax ($)</th>
            <th>Tips ($)</th>
            <th>Bonuses ($)</th>
            <th>Commissions ($)</th>
            <th>Taxes ($)</th>
            <th>Amount Earned ($)</th>
            <th>Amount Paid ($)</th>
            <th>Savings ($)</th>
          </tr>
      `;

      let totals = { bill: 0, hours: 0, earnings: 0, tips: 0, bonuses: 0, commissions: 0, taxes: 0, earned: 0, paid: 0, savings: 0 };

      bills.forEach(bill => {
        const netHourly = wage * (1 - taxRate);
        const exactHours = bill.amount / netHourly;
        const roundedHours = Math.ceil(exactHours);

        const earningsBeforeTax = roundedHours * wage;
        const totalIncome = earningsBeforeTax + tips + bonuses + commissions;
        const taxes = totalIncome * taxRate;
        const amountEarned = totalIncome - taxes;
        const savings = amountEarned - bill.amount;

        table += `
          <tr>
            <td data-label="Bill">${bill.name}</td>
            <td data-label="Bill Amount">$${bill.amount.toFixed(2)}</td>
            <td data-label="Hours Needed">${roundedHours}</td>
            <td data-label="Earnings Before Tax">$${earningsBeforeTax.toFixed(2)}</td>
            <td data-label="Tips">$${tips.toFixed(2)}</td>
            <td data-label="Bonuses">$${bonuses.toFixed(2)}</td>
            <td data-label="Commissions">$${commissions.toFixed(2)}</td>
            <td data-label="Taxes">$${taxes.toFixed(2)}</td>
            <td data-label="Amount Earned">$${amountEarned.toFixed(2)}</td>
            <td data-label="Amount Paid">$${bill.amount.toFixed(2)}</td>
            <td data-label="Savings">$${savings.toFixed(2)}</td>
          </tr>
        `;

        totals.bill += bill.amount;
        totals.hours += roundedHours;
        totals.earnings += earningsBeforeTax;
        totals.tips += tips;
        totals.bonuses += bonuses;
        totals.commissions += commissions;
        totals.taxes += taxes;
        totals.earned += amountEarned;
        totals.paid += bill.amount;
        totals.savings += savings;
      });

      table += `
        <tfoot>
          <tr>
            <td><b>Totals</b></td>
            <td>$${totals.bill.toFixed(2)}</td>
            <td>${totals.hours}</td>
            <td>$${totals.earnings.toFixed(2)}</td>
            <td>$${totals.tips.toFixed(2)}</td>
            <td>$${totals.bonuses.toFixed(2)}</td>
            <td>$${totals.commissions.toFixed(2)}</td>
            <td>$${totals.taxes.toFixed(2)}</td>
            <td>$${totals.earned.toFixed(2)}</td>
            <td>$${totals.paid.toFixed(2)}</td>
            <td>$${totals.savings.toFixed(2)}</td>
          </tr>
        </tfoot>
      </table>`;

      document.getElementById('result').innerHTML = table;
      document.getElementById('downloadButtons').style.display = "block";
    }

    function resetCalculator() {
      bills = [];
      document.getElementById('billList').innerHTML = '';
      document.getElementById('result').innerHTML = '';
      document.getElementById('downloadButtons').style.display = "none";
      document.getElementById('wage').value = '';
      document.getElementById('taxRate').value = 22;
      document.getElementById('tips').value = '';
      document.getElementById('bonuses').value = '';
      document.getElementById('commissions').value = '';
    }

    function downloadCSV() {
      const table = document.querySelector("table");
      if (!table) return alert("No table to download.");

      let csv = [];
      const rows = table.querySelectorAll("tr");

      rows.forEach(row => {
        const cols = row.querySelectorAll("td, th");
        const rowData = [];
        cols.forEach(col => {
          let text = col.innerText.replace(/,/g, "");
          rowData.push(text);
        });
        csv.push(rowData.join(","));
      });

      const csvFile = new Blob([csv.join("\n")], { type: "text/csv" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(csvFile);
      link.download = `work_hours_report_${new Date().toISOString().slice(0,10)}.csv`;
      link.click();
    }

    function downloadPDF() {
      const table = document.querySelector("table");
      if (!table) return alert("No table to download.");

      const printWindow = window.open('', '', 'height=600,width=1000');
      printWindow.document.write('<html><head><title>Work Hours Report</title>');
      printWindow.document.write('<style>body{font-family:Arial,sans-serif;} table { border-collapse: collapse; width: 100%; } th, td { border: 1px solid #ccc; padding: 10px; text-align: center; } th { background: #4CAF50; color: white; } tfoot { font-weight: bold; background: #eee; }</style>');
      printWindow.document.write('</head><body>');
      printWindow.document.write(`<h2>Work Hours & Bills Report (${new Date().toLocaleDateString()})</h2>`);
      printWindow.document.write(table.outerHTML);
      printWindow.document.write('</body></html>');
      printWindow.document.close();
      printWindow.print();
    }
  </
